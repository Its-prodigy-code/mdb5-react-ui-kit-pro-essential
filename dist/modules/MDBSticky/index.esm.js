import t from"clsx";import n,{useRef as e,useState as i,useCallback as o,useEffect as r}from"react";var c=function(){return c=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},c.apply(this,arguments)};function l(t){var n=function(t){var n=t.getBoundingClientRect();return{top:n.top+document.body.scrollTop,left:n.left+document.body.scrollLeft}}(t),e=t.getBoundingClientRect(),i=0===n.left&&0===n.top?0:window.innerHeight-e.bottom;return c(c({},n),{bottom:i})}var u=function(u){var s=u.className,a=u.stickyRef,f=u.stickyAnimationSticky,p=u.stickyAnimationUnsticky,y=u.stickyBoundary,d=u.stickyDelay,m=u.stickyDirection,h=u.stickyOffset,g=u.stickyPosition,k=u.tag,b=u.children,v=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)n.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(e[i[o]]=t[i[o]])}return e}(u,["className","stickyRef","stickyAnimationSticky","stickyAnimationUnsticky","stickyBoundary","stickyDelay","stickyDirection","stickyOffset","stickyPosition","tag","children"]),w=e(null),x=e(null),O=a||w,E=e(""),B=e(!1),P=e(0),R=e(0),j=e(0),A=i(),C=A[0],D=A[1],S=i(),z=S[0],L=S[1],T=i(!1),I=T[0],N=T[1],U=i({}),H=U[0],q=U[1],F=i(!1),Y=F[0],G=F[1],J=t("sticky",f&&I&&"animation "+f,p&&Y&&"animation "+p,s),K=o((function(){var t=x.current,n=O.current;P.current=t?t.offsetTop:n.offsetTop}),[O]),M=o((function(){var t=O.current;t&&(j.current="top"===g?P.current-d:P.current+t.height-document.body.scrollHeight+d)}),[d,g,O]),Q=o((function(t){t>R.current?E.current="down":E.current="up"}),[]),V=function(t,n){Object.keys(n).forEach((function(e){t.style[e]=n[e]}))},W=o((function(){var t=x.current,n=O.current;if(t){var e=t.getBoundingClientRect().left;q({left:e+"px"})}else q({});V(n,H),K()}),[K,H,O]),X=o((function(){var t,n=O.current,e=n.getBoundingClientRect().height,i=c({height:n.parentElement.getBoundingClientRect().height},l(n.parentElement)),o=document.querySelector(y);t=o?l(o).top-e-h:i.height+i[g]-e-h;var r,u="top"===g,s="bottom"===g,a=y,f=t<0,p=t>i.height-e;u&&(r=f&&a?{top:h+t+"px"}:{top:h+0+"px"}),s&&(r=f&&a?{bottom:h+t+"px"}:p&&a?{bottom:h+i.bottom+"px"}:{bottom:h+0+"px"}),V(n,r)}),[y,h,g,O]),Z=o((function(){var t=window.pageYOffset||document.documentElement.scrollTop;K(),M(),Q(t);var n=[E.current,"both"].includes(m),e=j.current<=t,i=e&&!B.current&&n,o=(!e||!n)&&B.current;if(i){var r=O.current.getBoundingClientRect(),c=r.height,l=r.left,u=r.width;N(!0),L({height:c+"px",width:u+"px",opacity:"0"}),D({top:"top"===g?0+h+"px":null,bottom:"bottom"===g?0+h+"px":null,height:c+"px",width:u+"px",left:l+"px",zIndex:"100",position:"fixed"}),X(),B.current=!0}o&&(p?(G(!0),setTimeout((function(){D({top:null,bottom:null,position:null,left:null,zIndex:null,width:null,height:null}),N(!1),L({height:null,width:null,opacity:null}),G(!1)}),200)):(D({top:null,bottom:null,position:null,left:null,zIndex:null,width:null,height:null}),N(!1),L({height:null,width:null,opacity:null})),B.current=!1),B.current&&(V(O.current,H),X()),R.current=t<=0?0:t}),[m,K,M,Q,h,g,O,H,X,p]);return r((function(){return window.addEventListener("resize",W),window.addEventListener("scroll",Z),function(){window.removeEventListener("resize",W),window.removeEventListener("scroll",Z)}}),[W,Z]),n.createElement(n.Fragment,null,I&&n.createElement(k,c({className:J,ref:x,style:z},v),b),n.createElement(k,c({className:J,ref:O,style:C},v),b))};u.defaultProps={stickyAnimationSticky:"",stickyAnimationUnsticky:"",tag:"span",stickyBoundary:!1,stickyDelay:0,stickyDirection:"down",stickyOffset:0,stickyPosition:"top"};export{u as default};
