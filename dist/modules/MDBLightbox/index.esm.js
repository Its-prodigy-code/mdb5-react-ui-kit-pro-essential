import e from"clsx";import t,{useRef as r,useState as l,useCallback as n,useEffect as o}from"react";import i from"react-dom";var c=function(){return c=Object.assign||function(e){for(var t,r=1,l=arguments.length;r<l;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},c.apply(this,arguments)};var a=function(a){var u=a.className,s=a.tag,f=a.zoomLevel,m=a.fontAwesome,g=a.children,d=a.lightboxRef,h=function(e,t){var r={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(r[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(l=Object.getOwnPropertySymbols(e);n<l.length;n++)t.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(r[l[n]]=e[l[n]])}return r}(a,["className","tag","zoomLevel","fontAwesome","children","lightboxRef"]),y=e("lightbox",u),b=r(null),p=r(null),v=r(null),x=r(null),w=r(null),E=r(null),N=d||E,A=l(!1),k=A[0],L=A[1],F=l(0),S=F[0],q=F[1],O=l(!1),j=O[0],z=O[1],P=l([]),C=P[0],D=P[1],H=l(1),M=H[0],T=H[1],W=l(!1),I=W[0],X=W[1],Y=l(""),R=Y[0],U=Y[1],V=r(),B=r(),G=r(),J=r(),K=r(),Q=r(),Z=function(e,t){var r=e;return r>t.length-1&&(r=0),t[r].classList.contains("lightbox-disabled")?Z(r+1,t):r},$=function(e,t){var r=e;return r<0&&(r=t.length-1),t[r].classList.contains("lightbox-disabled")?$(r-1,t):r},_=n((function(e){if(k)switch(e.preventDefault(),e.key){case"ArrowLeft":p.current&&p.current.click();break;case"ArrowRight":v.current&&v.current.click();break;case"ArrowUp":case"ArrowDown":w.current&&w.current.click();break;case"Escape":x.current&&x.current.click();break;case"Home":q(0);break;case"End":C.length>0&&q(C.length-1)}}),[k,C]),ee=n((function(e,t){var r;document.body.classList.add("overflow-hidden"),L(!0),q(t),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ce(e)}));var l=null===(r=b.current)||void 0===r?void 0:r.querySelector(".lightbox-gallery-item.active");U(null==l?void 0:l.getAttribute("alt"))}),[]),te=function(){var e=Z(S+1,C);q(e),T(1),X(!1),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ce(e)})),setTimeout((function(){var e,t=null===(e=b.current)||void 0===e?void 0:e.querySelector(".lightbox-gallery-item.active");U(null==t?void 0:t.getAttribute("alt"))}),10)},re=function(){var e=$(S-1,C);q(e),T(1),X(!1),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ce(e)})),setTimeout((function(){var e,t=null===(e=b.current)||void 0===e?void 0:e.querySelector(".lightbox-gallery-item.active");U(null==t?void 0:t.getAttribute("alt"))}),10)},le=n((function(){void 0===(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement)&&z(!1)}),[]),ne=function(e){e.preventDefault();var t=e.touches,r=e.target,l=t?t[0].clientX:e.clientX,n=t?t[0].clientY:e.clientY;G.current=parseFloat(r.style.left)||0,J.current=parseFloat(r.style.top)||0,V.current=parseFloat(r.style.left)||0,B.current=parseFloat(r.style.top)||0,K.current=l*(1/M)-V.current,Q.current=n*(1/M)-B.current,X(!0)},oe=function(e){if(I){var t=e.touches,r=t?t[0].clientX:e.clientX,l=t?t[0].clientY:e.clientY;if(1!==M)V.current=r*(1/M)-K.current,B.current=l*(1/M)-Q.current,e.target.style.left=V.current+"px",e.target.style.top=B.current+"px";else{if(C.length<=1)return;V.current=r*(1/M)-K.current,e.target.style.left=V.current+"px"}}},ie=function(){1===M&&(V.current>0?re():V.current<0&&te()),X(!1)},ce=function(e){e.width>=e.height?(e.style.width="100%",e.style.maxWidth="100%",e.style.height="auto",e.style.top=(e.parentNode.offsetHeight-e.height)/2+"px",e.style.left=0):(e.style.height="100%",e.style.maxHeight="100%",e.style.width="auto",e.style.left=(e.parentNode.offsetWidth-e.width)/2+"px",e.style.top=0),e.width>=e.parentNode.offsetWidth&&(e.style.width=e.parentNode.offsetWidth+"px",e.style.height="auto",e.style.left=0,e.style.top=(e.parentNode.offsetHeight-e.height)/2+"px"),e.height>=e.parentNode.offsetHeight&&(e.style.height=e.parentNode.offsetHeight+"px",e.style.width="auto",e.style.top=0,e.style.left=(e.parentNode.offsetWidth-e.width)/2+"px"),V.current=parseFloat(e.style.left)||0,B.current=parseFloat(e.style.top)||0};o((function(){var e=N.current.querySelectorAll(".lightbox-item");D(e)}),[N]),o((function(){C.length>0&&document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ce(e)}))}),[C]);var ae=n((function(){document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ce(e)}))}),[]);return o((function(){return window.addEventListener("resize",ae),window.addEventListener("keydown",(function(e){return _(e)})),window.addEventListener("fullscreenchange",le),C.forEach((function(e,t){!e.classList.contains("lightbox-disabled")&&e.addEventListener("click",(function(e){return ee(e,t)}))})),function(){window.removeEventListener("resize",ae),window.removeEventListener("keydown",(function(e){return _(e)})),window.removeEventListener("fullscreenchange",le),C.forEach((function(e,t){e.removeEventListener("click",(function(e){return ee(e,t)}))}))}}),[C,ee,ae,_,le]),t.createElement(t.Fragment,null,t.createElement(s,c({ref:N,className:y},h),g),i.createPortal(t.createElement("div",{className:"lightbox-gallery",onClick:function(e){"DIV"===e.target.tagName&&(document.body.classList.remove("overflow-hidden"),"DIV"===e.target.tagName&&L(!1))},ref:b,style:{opacity:k?1:0,pointerEvents:k?"initial":"none",visibility:k?"visible":"hidden"}},t.createElement("div",{className:"lightbox-gallery-loader"}),t.createElement("div",{className:"lightbox-gallery-toolbar"},t.createElement("div",{className:"lightbox-gallery-left-tools"},t.createElement("p",{className:"lightbox-gallery-counter"},S+1+" / "+C.length)),t.createElement("div",{className:"lightbox-gallery-right-tools"},t.createElement("button",{className:"lightbox-gallery-fullscreen-btn "+("pro"===m&&"fontawesome-pro")+" "+(j&&"active"),onClick:function(){var e;j?(document.exitFullscreen&&document.exitFullscreen(),z(!1)):((null===(e=b.current)||void 0===e?void 0:e.requestFullscreen)&&b.current.requestFullscreen(),z(!0))}}),t.createElement("button",{ref:w,className:"lightbox-gallery-zoom-btn "+("pro"===m&&"fontawesome-pro")+" "+(M>1&&"active"),onClick:function(){return M>1?(T(M-f),void document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ce(e)}))):function(e){T(M+e)}(f)}}),t.createElement("button",{className:"lightbox-gallery-close-btn "+("pro"===m&&"fontawesome-pro"),onClick:function(){j&&document.exitFullscreen&&document.exitFullscreen(),document.body.classList.remove("overflow-hidden"),L(!1),T(1),X(!1),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ce(e)}))},ref:x}))),t.createElement("div",{className:"lightbox-gallery-content"},Object.values(C).map((function(e,r){var l,n,o={source:(l=e).getAttribute("data-mdb-img")?l.getAttribute("data-mdb-img"):l.getAttribute("src")?l.getAttribute("src"):"",caption:l.getAttribute("data-mdb-caption")?l.getAttribute("data-mdb-caption"):l.getAttribute("alt")?l.getAttribute("alt"):""},i=o.source,c=o.caption,a=r===S?1:0,u=r===S?M:.25,s=S===C.length-1&&0===r,f=0===S&&r===C.length-1;return n=S<r&&!f&&!s?"100%":S>r&&!f&&!s||f?"-100%":s?"100%":"0%",t.createElement("div",{className:"lightbox-gallery-image",key:r,style:{position:"absolute",opacity:a,left:n,transform:"scale("+u+")"}},t.createElement("img",{src:i,alt:c,onMouseDown:function(e){return ne(e)},onMouseMove:function(e){return oe(e)},onMouseUp:ie,onTouchStart:function(e){return ne(e)},onTouchMove:function(e){return oe(e)},onTouchEnd:ie,className:"lightbox-gallery-item "+(S===r&&"active")}))}))),t.createElement("div",{className:"lightbox-gallery-arrow-left"},t.createElement("button",{"aria-label":"Previous",className:"pro"===m?"fontawesome-pro":"",onClick:re,ref:p})),t.createElement("div",{className:"lightbox-gallery-arrow-right"},t.createElement("button",{"aria-label":"Next",className:"pro"===m?"fontawesome-pro":"",onClick:te,ref:v})),t.createElement("div",{className:"lightbox-gallery-caption-wrapper"},t.createElement("p",{className:"lightbox-gallery-caption"},R))),document.body))};a.defaultProps={tag:"div",zoomLevel:1,fontAwesome:"free"};export{a as default};
