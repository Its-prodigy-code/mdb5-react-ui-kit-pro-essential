import e from"clsx";import t,{useRef as n,useState as r,useCallback as o,useEffect as l}from"react";import c from"react-dom";var a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};var i=function(i){var u=i.className,s=i.tag,f=i.zoomLevel,d=i.fontAwesome,m=i.children,g=i.lightboxRef,h=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(i,["className","tag","zoomLevel","fontAwesome","children","lightboxRef"]),y=e("lightbox",u),b=n(null),v=n(null),p=n(null),x=n(null),w=n(null),E=n(null),N=g||E,A=r(!1),k=A[0],L=A[1],F=r(0),S=F[0],O=F[1],q=r(!1),j=q[0],z=q[1],P=r([]),C=P[0],D=P[1],H=r(1),M=H[0],T=H[1],W=r(!1),I=W[0],X=W[1],Y=r(""),R=Y[0],U=Y[1],V=n(),B=n(),G=n(),J=n(),K=n(),Q=n(),Z=function(e,t){var n=e;return n>t.length-1&&(n=0),t[n].classList.contains("lightbox-disabled")?Z(n+1,t):n},$=function(e,t){var n=e;return n<0&&(n=t.length-1),t[n].classList.contains("lightbox-disabled")?$(n-1,t):n},_=o((function(e){if(k)switch(e.preventDefault(),e.key){case"ArrowLeft":v.current&&v.current.click();break;case"ArrowRight":p.current&&p.current.click();break;case"ArrowUp":case"ArrowDown":w.current&&w.current.click();break;case"Escape":x.current&&x.current.click();break;case"Home":O(0);break;case"End":C.length>0&&O(C.length-1)}}),[k,C]),ee=o((function(e,t){var n;document.body.classList.add("overflow-hidden"),L(!0),O(t),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ae(e)}));var r=null===(n=b.current)||void 0===n?void 0:n.querySelector(".lightbox-gallery-item.active");U(null==r?void 0:r.getAttribute("alt"))}),[]),te=function(){var e=Z(S+1,C);O(e),T(1),X(!1),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ae(e)})),setTimeout((function(){var e,t=null===(e=b.current)||void 0===e?void 0:e.querySelector(".lightbox-gallery-item.active");U(null==t?void 0:t.getAttribute("alt"))}),10)},ne=function(){var e=$(S-1,C);O(e),T(1),X(!1),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ae(e)})),setTimeout((function(){var e,t=null===(e=b.current)||void 0===e?void 0:e.querySelector(".lightbox-gallery-item.active");U(null==t?void 0:t.getAttribute("alt"))}),10)},re=o((function(){void 0===(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement)&&z(!1)}),[]),oe=function(e){e.preventDefault();var t=e.touches,n=e.target,r=t?t[0].clientX:e.clientX,o=t?t[0].clientY:e.clientY;G.current=parseFloat(n.style.left)||0,J.current=parseFloat(n.style.top)||0,V.current=parseFloat(n.style.left)||0,B.current=parseFloat(n.style.top)||0,K.current=r*(1/M)-V.current,Q.current=o*(1/M)-B.current,X(!0)},le=function(e){if(I){var t=e.touches,n=t?t[0].clientX:e.clientX,r=t?t[0].clientY:e.clientY;if(1!==M)V.current=n*(1/M)-K.current,B.current=r*(1/M)-Q.current,e.target.style.left="".concat(V.current,"px"),e.target.style.top="".concat(B.current,"px");else{if(C.length<=1)return;V.current=n*(1/M)-K.current,e.target.style.left="".concat(V.current,"px")}}},ce=function(){1===M&&(V.current>0?ne():V.current<0&&te()),X(!1)},ae=function(e){e.width>=e.height?(e.style.width="100%",e.style.maxWidth="100%",e.style.height="auto",e.style.top="".concat((e.parentNode.offsetHeight-e.height)/2,"px"),e.style.left=0):(e.style.height="100%",e.style.maxHeight="100%",e.style.width="auto",e.style.left="".concat((e.parentNode.offsetWidth-e.width)/2,"px"),e.style.top=0),e.width>=e.parentNode.offsetWidth&&(e.style.width="".concat(e.parentNode.offsetWidth,"px"),e.style.height="auto",e.style.left=0,e.style.top="".concat((e.parentNode.offsetHeight-e.height)/2,"px")),e.height>=e.parentNode.offsetHeight&&(e.style.height="".concat(e.parentNode.offsetHeight,"px"),e.style.width="auto",e.style.top=0,e.style.left="".concat((e.parentNode.offsetWidth-e.width)/2,"px")),V.current=parseFloat(e.style.left)||0,B.current=parseFloat(e.style.top)||0},ie=o((function(){var e=N.current.querySelectorAll(".lightbox-item");D(e)}),[N]),ue=o((function(e){for(var t=0,n=e;t<n.length;t++){"childList"===n[t].type&&ie()}}),[ie]);l((function(){ie()}),[ie]),l((function(){C.length>0&&document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ae(e)}))}),[C]);var se=o((function(){document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ae(e)}))}),[]);return l((function(){window.addEventListener("resize",se),window.addEventListener("keydown",(function(e){return _(e)})),window.addEventListener("fullscreenchange",re);var e=new MutationObserver(ue);return e.observe(N.current,{childList:!0,subtree:!0}),C.forEach((function(e,t){!e.classList.contains("lightbox-disabled")&&e.addEventListener("click",(function(e){return ee(e,t)}))})),function(){e.disconnect(),window.removeEventListener("resize",se),window.removeEventListener("keydown",(function(e){return _(e)})),window.removeEventListener("fullscreenchange",re),C.forEach((function(e,t){e.removeEventListener("click",(function(e){return ee(e,t)}))}))}}),[C,N,ue,ee,se,_,re]),t.createElement(t.Fragment,null,t.createElement(s,a({ref:N,className:y},h),m),c.createPortal(t.createElement("div",{className:"lightbox-gallery",onClick:function(e){"DIV"===e.target.tagName&&(document.body.classList.remove("overflow-hidden"),"DIV"===e.target.tagName&&L(!1))},ref:b,style:{opacity:k?1:0,pointerEvents:k?"initial":"none",visibility:k?"visible":"hidden"}},t.createElement("div",{className:"lightbox-gallery-loader"}),t.createElement("div",{className:"lightbox-gallery-toolbar"},t.createElement("div",{className:"lightbox-gallery-left-tools"},t.createElement("p",{className:"lightbox-gallery-counter"},"".concat(S+1," / ").concat(C.length))),t.createElement("div",{className:"lightbox-gallery-right-tools"},t.createElement("button",{className:"lightbox-gallery-fullscreen-btn ".concat("pro"===d&&"fontawesome-pro"," ").concat(j&&"active"),onClick:function(){var e;j?(document.exitFullscreen&&document.exitFullscreen(),z(!1)):((null===(e=b.current)||void 0===e?void 0:e.requestFullscreen)&&b.current.requestFullscreen(),z(!0))}}),t.createElement("button",{ref:w,className:"lightbox-gallery-zoom-btn ".concat("pro"===d&&"fontawesome-pro"," ").concat(M>1&&"active"),onClick:function(){return M>1?(T(M-f),void document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ae(e)}))):function(e){T(M+e)}(f)}}),t.createElement("button",{className:"lightbox-gallery-close-btn ".concat("pro"===d&&"fontawesome-pro"),onClick:function(){j&&document.exitFullscreen&&document.exitFullscreen(),document.body.classList.remove("overflow-hidden"),L(!1),T(1),X(!1),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){ae(e)}))},ref:x}))),t.createElement("div",{className:"lightbox-gallery-content"},Object.values(C).map((function(e,n){var r,o,l={source:(r=e).getAttribute("data-mdb-img")?r.getAttribute("data-mdb-img"):r.getAttribute("src")?r.getAttribute("src"):"",caption:r.getAttribute("data-mdb-caption")?r.getAttribute("data-mdb-caption"):r.getAttribute("alt")?r.getAttribute("alt"):""},c=l.source,a=l.caption,i=n===S?1:0,u=n===S?M:.25,s=S===C.length-1&&0===n,f=0===S&&n===C.length-1;return o=S<n&&!f&&!s?"100%":S>n&&!f&&!s||f?"-100%":s?"100%":"0%",t.createElement("div",{className:"lightbox-gallery-image",key:n,style:{position:"absolute",opacity:i,left:o,transform:"scale(".concat(u,")")}},t.createElement("img",{src:c,alt:a,onMouseDown:function(e){return oe(e)},onMouseMove:function(e){return le(e)},onMouseUp:ce,onTouchStart:function(e){return oe(e)},onTouchMove:function(e){return le(e)},onTouchEnd:ce,className:"lightbox-gallery-item ".concat(S===n&&"active")}))}))),t.createElement("div",{className:"lightbox-gallery-arrow-left"},t.createElement("button",{"aria-label":"Previous",className:"".concat("pro"===d?"fontawesome-pro":""),onClick:ne,ref:v})),t.createElement("div",{className:"lightbox-gallery-arrow-right"},t.createElement("button",{"aria-label":"Next",className:"".concat("pro"===d?"fontawesome-pro":""),onClick:te,ref:p})),t.createElement("div",{className:"lightbox-gallery-caption-wrapper"},t.createElement("p",{className:"lightbox-gallery-caption"},R))),document.body))};i.defaultProps={tag:"div",zoomLevel:1,fontAwesome:"free"};export{i as default};
